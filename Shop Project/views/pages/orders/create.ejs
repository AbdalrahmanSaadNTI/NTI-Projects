<%- include('../../partials/siteHeader', { pageTitle: "Create Order", user: user }) %>

<div class="card">
    <div class="card-header">
        <h2 class="card-title">Create New Order</h2>
    </div>
    <div class="card-body">
        <form action="/orders" method="POST" id="orderForm">
            <h4>Customer Information</h4>
            <div class="form-group">
                <label for="customerName">Customer Name</label>
                <input type="text" id="customerName" name="customerName" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="customerPhone">Customer Phone</label>
                <input type="text" id="customerPhone" name="customerPhone" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="customerAddress">Customer Address</label>
                <input type="text" id="customerAddress" name="customerAddress" class="form-control" required>
            </div>

            <h4 style="margin-top:2rem;">Order Products</h4>
            <div id="productsContainer">
                <div class="product-row">
                    <div class="form-group">
                        <label>Product Name</label>
                        <input type="text" name="products[0][ProductName]" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label>Quantity</label>
                        <input type="number" name="products[0][quantity]" class="form-control" min="1" required>
                    </div>
                    <div class="form-group">
                        <label>Price</label>
                        <input type="number" name="products[0][price]" class="form-control" min="0" step="0.01" required>
                    </div>
                    <button type="button" class="btn btn-danger" onclick="removeProductRow(this)">Remove</button>
                </div>
            </div>
            <button type="button" class="btn btn-secondary" onclick="addProductRow()">+ Add Product</button>

            <div style="margin-top:2rem;">
                <button type="submit" class="btn btn-primary">Create Order</button>
                <a href="/orders" class="btn btn-secondary">Cancel</a>
            </div>
        </form>
    </div>
</div>

<script>
let productIndex = 1;
function addProductRow() {
    const container = document.getElementById('productsContainer');
    const row = document.createElement('div');
    row.className = 'product-row';
    row.innerHTML = `
        <div class="form-group">
            <label>Product Name</label>
            <input type="text" name="products[${productIndex}][ProductName]" class="form-control" required>
        </div>
        <div class="form-group">
            <label>Quantity</label>
            <input type="number" name="products[${productIndex}][quantity]" class="form-control" min="1" required>
        </div>
        <div class="form-group">
            <label>Price</label>
            <input type="number" name="products[${productIndex}][price]" class="form-control" min="0" step="0.01" required>
        </div>
        <button type="button" class="btn btn-danger" onclick="removeProductRow(this)">Remove</button>
    `;
    container.appendChild(row);
    productIndex++;
}
function removeProductRow(btn) {
    btn.parentElement.remove();
}
</script>

<%- include('../../partials/siteFooter') %>